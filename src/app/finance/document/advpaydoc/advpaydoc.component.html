<md-card>
  <md-card-title>{{"Finance.AdvancePayment" | translate}}</md-card-title>
  <md-card-subtitle>{{currentMode | translate}}</md-card-subtitle>
  <md-divider></md-divider>
  <md-card-content>
    <div layout="column" layout-padding>
      <div layout="row" layout-margin>
        <md-input-container flex>
          <input mdInput placeholder="{{'Common.ID' | translate}}" readonly [(ngModel)]="docObject.Id" name="id" #id="ngModel">
        </md-input-container>
      </div>
      <div layout="row" layout-margin>
        <md-input-container flex>
          <input mdInput type="date" placeholder="{{'Finance.TransactionDate' | translate}}" required [(ngModel)]="docObject.TranDateString" name="trandate"
              #trandate="ngModel">
        </md-input-container>
      </div>
      <div layout="row" layout-margin>
        <md-select flex="90" placeholder="{{'Finance.Account' | translate}}" [(ngModel)]="uiObject.SourceAccountId" name="frmaccount" #frmaccount="ngModel">
          <md-option *ngFor="let sacnt of arAccount" [value]="sacnt.Id">
            {{sacnt.Id}} - {{sacnt.Name}}
          </md-option>
        </md-select>
      </div>
      <div layout="row" layout-margin>
        <md-select flex="90" placeholder="{{'Finance.TransactionType' | translate}}" [(ngModel)]="uiObject.SourceTranType" name="srctrantype" #srctrantype="ngModel">
          <md-option *ngFor="let dt of arTranType" [value]="dt.Id" [class.bgc-green-300]="dt.Expense" [class.bgc-red-300]="!dt.Expense">
            ({{dt.Id}}) - {{dt.Name}}
          </md-option>
        </md-select>
      </div>
      <div layout="row" layout-margin>
        <md-input-container flex>
          <input mdInput type="number" placeholder="{{'Finance.Amount' | translate}}" required [(ngModel)]="uiObject.TranAmount" name="itemtranamt"
                #itemtranamt="ngModel">
        </md-input-container>
      </div>
      <div layout="row" layout-margin>
        <md-select flex="90" placeholder="{{'Finance.Currency' | translate}}" [(ngModel)]="docObject.TranCurr" name="trancurr" #trancurr="ngModel">
          <md-option *ngFor="let cur of arCurrency" [value]="cur.Currency">
              {{cur.Symbol}} - {{cur.Name}}
          </md-option>
        </md-select>
      </div>
      <div layout="row" layout-margin>
          <md-input-container flex>
            <textarea mdInput placeholder="{{'Common.Description' | translate}}" [(ngModel)]="docObject.Desp" name="desp" #desp="ngModel"></textarea>
          </md-input-container>
      </div>
      <div layout="row" layout-margin>
        <md-select flex="95" placeholder="{{'Finance.ControlCenter' | translate}}" [(ngModel)]="uiObject.SourceControlCenterId" name="srccc" #srccc="ngModel">
          <md-option value="" class="bgc-grey-800">{{'Common.PleaseSelect' | translate}}</md-option>
          <md-option *ngFor="let cc of arControlCenter" [value]="cc.Id">
            {{cc.Id}} - {{cc.Name}}
          </md-option>
        </md-select>
      </div>
      <div layout="row" layout-margin>
        <md-select flex="95" placeholder="{{'Finance.Order' | translate}}" [(ngModel)]="uiObject.SourceOrderId" name="srcorder" #srcorder="ngModel">
          <md-option value="" class="bgc-grey-800">{{'Common.PleaseSelect' | translate}}</md-option>
          <md-option *ngFor="let ord of arOrder" [value]="ord.Id">            
            {{ord.Id}} - {{ord.Name}}
          </md-option>
        </md-select>
      </div>
      <div layout="row" layout-padding style="border:2px solid grey;">
        <md-tab-group flex>
          <md-tab>
            <ng-template md-tab-label>
              <em>Detail</em> Info
            </ng-template>
            <div layout="column" layout-padding>
                <div layout="row" layout-margin>
                  <md-slide-toggle [(ngModel)]="uiObject.AdvPayAccount.Direct" name="dir">Direct</md-slide-toggle>
                </div>
                <div layout="row" layout-margin>
                  <md-input-container flex>
                    <input mdInput type="date" placeholder="{{'Common.Start' | translate}}" required [(ngModel)]="uiObject.AdvPayAccount.StartDateString" name="startdate" #startdate="ngModel">
                  </md-input-container>
                </div>
                <div layout="row" layout-margin>
                  <md-input-container flex>
                    <input mdInput type="date" placeholder="End" required [(ngModel)]="uiObject.AdvPayAccount.EndDateString" name="enddate" #enddate="ngModel">
                  </md-input-container>
                </div>
                <div layout="row" layout-margin>
                  <md-select placeholder="Repeat frequency" [(ngModel)]="uiObject.AdvPayAccount.RepeatType" name="rpttype" flex>
                    <md-option *ngFor="let rt of arRepeatFrequency" [value]="rt.Id">
                      {{rt.DisplayString}}
                    </md-option>
                  </md-select>
                </div>
                <div layout="row" layout-margin>
                  <md-input-container flex>
                    <input mdInput type="number" placeholder="Deferred days" [(ngModel)]="uiObject.AdvPayAccount.DeferredDays" name="dfrrdays" #dfrrdays="ngModel">
                  </md-input-container>
                </div>
                <div layout="row" layout-margin>
                  <md-input-container flex>
                    <input mdInput type="text" placeholder="{{'Common.Comment' | translate}}" [(ngModel)]="uiObject.AdvPayAccount.Comment" name="advacntcmt" #advacntcmt="ngModel">
                  </md-input-container>
                </div>
                <div layout="row" layout-padding>
                  <button md-button color="accent" (click)="onSync()">Sync</button>
                </div>       
              </div>
          </md-tab>
          <md-tab>
            <ng-template md-tab-label>
              <md-icon>list</md-icon>Template Docs
            </ng-template>

            <td-data-table 
              [data]="tmpDocs" 
              [columns]="clnTmpDocs" 
              selectable="true"
              multiple="false"
              [(ngModel)]="selectedTmpDocs">
            </td-data-table>
            <div *ngIf="selectedTmpDocs.length > 0">
              <md-divider></md-divider>
              <md-card>
                <md-card-content>
                  <h3 md-line>Template Detail</h3>
                  <form #tmpDocDetailForm="ngForm">
                    <div layout="row" layout-margin>
                      <md-input-container flex>
                        <input mdInput type="number" placeholder="Doc ID"  [(ngModel)]="selectedTmpDocs[0].DocId" name="tmpdocid" #tmpdocid="ngModel">
                      </md-input-container>
                    </div>
                    <div layout="row" layout-margin>
                      <md-input-container flex>
                        <input mdInput type="number" placeholder="Ref Doc ID" [(ngModel)]="selectedTmpDocs[0].RefDocId" name="tmprefdocid" #tmprefdocid="ngModel">
                      </md-input-container>
                    </div>
                    <div layout="row" layout-margin>
                      <md-input-container flex>
                        <input mdInput type="date" placeholder="{{'Finance.TransactionDate' | translate}}" required [(ngModel)]="selectedTmpDocs[0].TranDateString" name="tmptrandate" #tmptrandate="ngModel">
                      </md-input-container>
                    </div>
                    <div layout="row" layout-margin>
                      <md-input-container flex>
                        <input mdInput type="number" placeholder="{{'Finance.Amount' | translate}}" required [(ngModel)]="selectedTmpDocs[0].TranAmount" name="tmptranamt" #tmptranamt="ngModel">
                      </md-input-container>
                    </div>
                  </form>
                </md-card-content>
                <md-card-actions>
                  <button md-button color="accent" [disabled]="!tmpDocDetailForm.form.valid" (click)="onTmpDocSubmit()">Update Tmp Doc</button>
                  <button md-button formnovalidate (click)="onTmpDocReset()">Reset current tmp</button>
                </md-card-actions>
              </md-card>
            </div>
          </md-tab>
        </md-tab-group>
      </div>
      <div layout="row" layout-padding>
        <button md-button color="accent" (click)="onSubmit()">{{'Common.Submit' | translate}}</button>
        <button md-button formnovalidate>{{'Common.Cancel' | translate}}</button>
      </div>
    </div>
  </md-card-content>
</md-card>
